# @package _global_

defaults:
  - default

algorithm_name: grpo

algorithm:
  use_kl_in_reward: False
  adv_estimator: grpo

actor_rollout_ref:
  ref:
    fsdp_config:
      param_offload: True
    log_prob_micro_batch_size_per_gpu: 16

  model:
    use_remove_padding: True
    enable_gradient_checkpointing: True

  rollout: 
    gpu_memory_utilization: 0.6
    n: 8 # grpo n > 1
    log_prob_micro_batch_size_per_gpu: 16
    tensor_model_parallel_size: 1

  actor:
    optim:
      lr: 1e-6
    ppo_mini_batch_size: 256 
    ppo_micro_batch_size_per_gpu: 16

    use_kl_loss: True
    kl_loss_coef: 0.001
    kl_loss_type: low_var_kl
    
    entropy_coeff: 0

    fsdp_config:
      param_offload: False
      optimizer_offload: False
